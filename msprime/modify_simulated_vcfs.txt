###Modify the msprime VCF files such that compression and indexing become possible

cd /scratch/project_2001443/barriers_introgr_formica/msprime/chr_test/sim_1

#extract contig info for all 10kb blocks
gunzip -c output.vcf.gz | grep "##contig" > scaffolds.txt

#remove the additional headers (from the middle of the file, before each block starts)
gunzip -c output.vcf.gz | awk 'NR <= 6 || (NR > 6 && !/^#/)' > output_only1stHeader.vcf.gz

#replace the "Scaffold" line of the first header that was kept, with info on all headers
sed -i '/##contig=<ID=Scaffold1,length=10000>/r scaffolds.txt' output_only1stHeader.vcf.gz

#compress the file
bgzip output_only1stHeader.vcf.gz
mv output_only1stHeader.vcf.gz.gz output_only1stHeader.vcf.gz

#index the file.
tabix -p vcf output_only1stHeader.vcf.gz
